<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Raffle</title>
    <style>
      #loading {
        font-size: 18px;
        color: #555;
      }
    </style>
  </head>
  <body>
    <div id="loading">載入中... 請稍候</div>

    <button id="btnAssign" onclick="assignNumbers()" disabled>分配號碼</button>
    <button id="btnDraw" onclick="drawNumber()" disabled>抽獎</button>
    <p id="output"></p>

    <!-- 先定義 Module，確保 Emscripten 初始化時能找到 -->
    <script>
      var Module = {
        onRuntimeInitialized: function () {
          // 使用 cwrap 將 C 函式轉成 JS 可呼叫的形式
          window.assign_numbers = Module.cwrap("assign_numbers", null, []);
          window.draw_number = Module.cwrap("draw_number", "number", []);

          // 設定按鈕功能
          window.assignNumbers = function () {
            assign_numbers();
            document.getElementById("output").innerText = "號碼已分配！";
          };

          window.drawNumber = function () {
            var number = draw_number();
            document.getElementById("output").innerText = "抽中的號碼是：" + number;
          };

          // 啟用按鈕 & 移除載入提示
          document.getElementById("btnAssign").disabled = false;
          document.getElementById("btnDraw").disabled = false;
          document.getElementById("loading").style.display = "none";
        }
      };
    </script>

    <!-- 必須放在 Module 宣告之後 -->
    <script src="index.js"></script>
  </body>
</html>
