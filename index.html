<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>🎯 抽獎小程式</title>
<style>
body {
font-family: Arial, sans-serif;
text-align: center;
color: #003366; /* 深藍色字體 */
}
#loading {
font-size: 18px;
color: #555; /* 灰色 */
}
#playerList {
margin-top: 10px;
text-align: left;
display: inline-block;
}
</style>
</head>
<body>
<h1>🎯 抽獎小程式</h1>
<div id="loading">載入中... 請稍候</div>

<button id="btnAssign" onclick="assignNumbers()" disabled>分配號碼</button>
<button id="btnDraw" onclick="drawNumber()" disabled>抽獎</button>
<p id="output"></p>
<div id="playerList"></div>

<!-- 必須在 index.js 之前定義 Module -->
<script>
var Module = {
onRuntimeInitialized: function () {
// 對應 C++ 函式
window.assign_numbers = Module.cwrap("assign_numbers", null, []);
window.draw_number = Module.cwrap("draw_number", "number", []);
window.get_player_count = Module.cwrap("get_player_count", "number", []);
window.get_player_name = Module.cwrap("get_player_name", "string", ["number"]);
window.get_player_number = Module.cwrap("get_player_number", "number", ["number"]);

// 分配號碼
window.assignNumbers = function () {
assign_numbers();
let count = get_player_count();
let listHtml = "<h3>玩家名單</h3><ul>";
for (let i = 0; i < count; i++) {
let name = get_player_name(i);
let num = get_player_number(i);
listHtml += `<li>${name} ➡️ 號碼 ${num}</li>`;
}
listHtml += "</ul>";
document.getElementById("playerList").innerHTML = listHtml;
document.getElementById("output").innerText = "號碼已分配！";
};

// 抽獎
window.drawNumber = function () {
let number = draw_number();
document.getElementById("output").innerText = "抽中的號碼是：" + number;
};

// 啟用按鈕 & 移除載入提示
document.getElementById("btnAssign").disabled = false;
document.getElementById("btnDraw").disabled = false;
document.getElementById("loading").style.display = "none";
}
};
</script>

<!-- 一定要放在 Module 宣告之後 -->
<script src="index.js"></script>
</body>
</html>
